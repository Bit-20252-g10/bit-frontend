<!-- dashboard.html -->
<div class="max-w-6xl mx-auto p-6">
  <!-- Botón de logout -->
  <div class="flex justify-end mb-4">
    <button (click)="logout()" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition">
      Cerrar Sesión
    </button>
  </div>

  <!-- Mensajes Toastr reemplazan estos mensajes -->
  <!-- Sección de Juegos -->
  <div class="mb-8">
    <h2 class="text-2xl font-bold mb-4">Panel de Control - Juegos</h2>

    <!-- Botón alternar formulario -->
    <button (click)="showAddForm = !showAddForm"
            class="mb-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">
      {{ showAddForm ? 'Cancelar' : 'Agregar Juego' }}
    </button>

    <!-- Tabla de Juegos -->
    <table *ngIf="games.length > 0" class="min-w-full bg-black border border-gray-600 rounded">
      <thead>
        <tr>
          <th class="py-2 px-4 border-b border-gray-600 text-white">Imagen</th>
          <th class="py-2 px-4 border-b border-gray-600 text-white">Nombre</th>
          <th class="py-2 px-4 border-b border-gray-600 text-white">Descripción</th>
          <th class="py-2 px-4 border-b border-gray-600 text-white">Precio</th>
          <th class="py-2 px-4 border-b border-gray-600 text-white">Stock</th>
          <th class="py-2 px-4 border-b border-gray-600 text-white">Consola</th>
          <th class="py-2 px-4 border-b border-gray-600 text-white">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let game of games; let i = index" class="hover:bg-gray-800 border-b border-gray-600">
          <td class="py-2 px-4 border-b">
            <img *ngIf="game.imageUrl" [src]="game.imageUrl" [alt]="game.name" class="w-16 h-16 object-cover rounded" />
            <span *ngIf="!game.imageUrl" class="text-gray-500">Sin imagen</span>
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editIndex !== i">{{ game.name }}</span>
            <input *ngIf="editIndex === i" type="text" [(ngModel)]="editedGame.name"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editIndex !== i">{{ game.descripcion || 'Sin descripción' }}</span>
            <textarea *ngIf="editIndex === i" [(ngModel)]="editedGame.descripcion"
                      class="w-full border border-gray-300 px-2 py-1 rounded text-sm" rows="2"></textarea>
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editIndex !== i">{{ game.precio | currency:'USD':'symbol':'1.2-2' }}</span>
            <input *ngIf="editIndex === i" type="number" [(ngModel)]="editedGame.precio"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editIndex !== i" [class]="getStockClass(game.stock)">{{ game.stock }}</span>
            <input *ngIf="editIndex === i" type="number" [(ngModel)]="editedGame.stock"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editIndex !== i">{{ game.consola || 'N/A' }}</span>
            <input *ngIf="editIndex === i" type="text" [(ngModel)]="editedGame.consola"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <div *ngIf="editIndex !== i" class="flex space-x-2">
              <button (click)="startEdit(i)" class="px-2 py-1 bg-yellow-500 text-white rounded text-xs">Editar</button>
              <button (click)="deleteGame(game, i)" class="px-2 py-1 bg-red-500 text-white rounded text-xs">Eliminar</button>
            </div>
            <div *ngIf="editIndex === i" class="flex space-x-2">
              <button (click)="saveEdit()" class="px-2 py-1 bg-green-500 text-white rounded text-xs">Guardar</button>
              <button (click)="cancelEdit()" class="px-2 py-1 bg-gray-500 text-white rounded text-xs">Cancelar</button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="games.length === 0 && !isLoading" class="text-center py-8 text-gray-500">
      No hay juegos disponibles
    </div>

    <!-- Formulario de agregar juego -->
    <form *ngIf="showAddForm" (ngSubmit)="addGame()" #gameForm="ngForm" class="space-y-4">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block font-semibold">Nombre</label>
        <input name="name" [(ngModel)]="newGame.name" required
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Consola</label>
        <input name="consola" [(ngModel)]="newGame.consola"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Género</label>
        <input name="genero" [(ngModel)]="newGame.genero"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Año de Lanzamiento</label>
        <input type="number" name="releaseYear" [(ngModel)]="newGame.releaseYear"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Precio</label>
        <input type="number" name="precio" [(ngModel)]="newGame.precio" required min="0"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Stock</label>
        <input type="number" name="stock" [(ngModel)]="newGame.stock" required min="0"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Calificación (0-5)</label>
        <input type="number" name="rating" [(ngModel)]="newGame.rating" min="0" max="5"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Multijugador</label>
        <input type="checkbox" name="multiplayer" [(ngModel)]="newGame.multiplayer"
               class="mr-2" />
        Sí
      </div>

      <div>
        <label class="block font-semibold">Desarrollador</label>
        <input name="developer" [(ngModel)]="newGame.developer"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Distribuidor</label>
        <input name="publisher" [(ngModel)]="newGame.publisher"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div class="md:col-span-2">
        <label class="block font-semibold">Descripción</label>
        <textarea name="descripcion" [(ngModel)]="newGame.descripcion"
                  class="w-full border border-gray-300 px-3 py-2 rounded" rows="3"></textarea>
      </div>

      <div class="md:col-span-2">
        <label class="block font-semibold">Imagen del Juego</label>
        <input type="file" (change)="onFileSelected($event)"
               accept="image/*"
               class="w-full" />
      </div>
    </div>

    <button type="submit" [disabled]="!gameForm.form.valid || isUploading"
            class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 transition">
      {{ isUploading ? 'Subiendo imagen...' : 'Guardar Juego' }}
    </button>
  </form>
</div>
<!-- Formulario de agregar consola (dashboard.html) -->
<div class="max-w-4xl mx-auto p-6">
  <!-- Alternar formulario -->
  <!-- <button (click)="showAddConsoleForm = !showAddConsoleForm"
          class="mb-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition">
    {{ showAddConsoleForm ? 'Cancelar' : 'Agregar Consola' }}
  </button> -->

  <!-- Formulario Consola -->
  <form *ngIf="showAddConsoleForm" (ngSubmit)="addConsole()" #consoleForm="ngForm" class="space-y-4">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block font-semibold">Nombre</label>
        <input name="name" [(ngModel)]="newConsole.name" required
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Marca</label>
        <input name="brand" [(ngModel)]="newConsole.brand"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Modelo</label>
        <input name="model" [(ngModel)]="newConsole.model"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Año de Lanzamiento</label>
        <input type="number" name="releaseYear" [(ngModel)]="newConsole.releaseYear"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Precio</label>
        <input type="number" name="price" [(ngModel)]="newConsole.price" required min="0"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Stock</label>
        <input type="number" name="stock" [(ngModel)]="newConsole.stock" required min="0"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Color</label>
        <input name="color" [(ngModel)]="newConsole.color"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div class="md:col-span-2">
        <label class="block font-semibold">Características</label>
        <textarea name="features" [(ngModel)]="newConsole.features"
                  class="w-full border border-gray-300 px-3 py-2 rounded" rows="3"></textarea>
      </div>

      <div class="md:col-span-2">
        <label class="block font-semibold">Descripción</label>
        <textarea name="description" [(ngModel)]="newConsole.description"
                  class="w-full border border-gray-300 px-3 py-2 rounded" rows="3"></textarea>
      </div>

      <div class="md:col-span-2">
        <label class="block font-semibold">Imagen</label>
        <input type="file" (change)="onConsoleImageSelected($event)"
               accept="image/*"
               class="w-full" />
      </div>
    </div>

    <button type="submit" [disabled]="!consoleForm.form.valid || isUploading"
            class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 transition">
      {{ isUploading ? 'Subiendo imagen...' : 'Guardar Consola' }}
    </button>
  </form>
</div>
<!-- Sección agregar accesorio -->
<div class="max-w-4xl mx-auto p-6">
  <!-- Botón mostrar/ocultar formulario -->
  <!-- <button (click)="showAddAccessoryForm = !showAddAccessoryForm"
          class="mb-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition">
    {{ showAddAccessoryForm ? 'Cancelar' : 'Agregar Accesorio' }}
  </button> -->

  <!-- Formulario accesorio -->
  <form *ngIf="showAddAccessoryForm" (ngSubmit)="addAccessory()" #accessoryForm="ngForm" class="space-y-4">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block font-semibold">Nombre</label>
        <input name="name" [(ngModel)]="newAccessory.name" required
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Marca</label>
        <input name="brand" [(ngModel)]="newAccessory.brand"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Categoría</label>
        <input name="category" [(ngModel)]="newAccessory.category"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Precio</label>
        <input type="number" name="price" [(ngModel)]="newAccessory.price" required min="0"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div>
        <label class="block font-semibold">Stock</label>
        <input type="number" name="stock" [(ngModel)]="newAccessory.stock" required min="0"
               class="w-full border border-gray-300 px-3 py-2 rounded" />
      </div>

      <div class="md:col-span-2">
        <label class="block font-semibold">Descripción</label>
        <textarea name="description" [(ngModel)]="newAccessory.description"
                  class="w-full border border-gray-300 px-3 py-2 rounded" rows="3"></textarea>
      </div>

      <div class="md:col-span-2">
        <label class="block font-semibold">Imagen</label>
        <input type="file" (change)="onAccessoryImageSelected($event)"
               accept="image/*"
               class="w-full" />
      </div>
    </div>

    <button type="submit" [disabled]="!accessoryForm.form.valid || isUploading"
            class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 transition">
      {{ isUploading ? 'Subiendo imagen...' : 'Guardar Accesorio' }}
    </button>
  </form>
</div>

  <!-- Sección de Consolas -->
  <div class="mb-8">
    <h2 class="text-2xl font-bold mb-4">Consolas</h2>

    <!-- Botón alternar formulario -->
    <button (click)="showAddConsoleForm = !showAddConsoleForm"
            class="mb-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition">
      {{ showAddConsoleForm ? 'Cancelar' : 'Agregar Consola' }}
    </button>

    <!-- Tabla de Consolas -->
    <table *ngIf="consoles.length > 0" class="min-w-full bg-white border border-gray-300 rounded">
      <thead>
        <tr>
          <th class="py-2 px-4 border-b">Imagen</th>
          <th class="py-2 px-4 border-b">Nombre</th>
          <th class="py-2 px-4 border-b">Categoría</th>
          <th class="py-2 px-4 border-b">Descripción</th>
          <th class="py-2 px-4 border-b">Precio</th>
          <th class="py-2 px-4 border-b">Stock</th>
          <th class="py-2 px-4 border-b">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let console of consoles; let i = index" class="hover:bg-gray-100">
          <td class="py-2 px-4 border-b">
            <img *ngIf="console.imageUrl" [src]="console.imageUrl" [alt]="console.name" class="w-16 h-16 object-cover rounded" />
            <span *ngIf="!console.imageUrl" class="text-gray-500">Sin imagen</span>
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editConsoleIndex !== i">{{ console.name }}</span>
            <input *ngIf="editConsoleIndex === i" type="text" [(ngModel)]="editedConsole.name"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editConsoleIndex !== i">{{ console.category || 'N/A' }}</span>
            <input *ngIf="editConsoleIndex === i" type="text" [(ngModel)]="editedConsole.category"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editConsoleIndex !== i">{{ console.description || 'Sin descripción' }}</span>
            <textarea *ngIf="editConsoleIndex === i" [(ngModel)]="editedConsole.description"
                      class="w-full border border-gray-300 px-2 py-1 rounded text-sm" rows="2"></textarea>
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editConsoleIndex !== i">{{ console.price | currency }}</span>
            <input *ngIf="editConsoleIndex === i" type="number" [(ngModel)]="editedConsole.price"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editConsoleIndex !== i" [class]="getStockClass(console.stock)">{{ console.stock }}</span>
            <input *ngIf="editConsoleIndex === i" type="number" [(ngModel)]="editedConsole.stock"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <div *ngIf="editConsoleIndex !== i" class="flex space-x-2">
              <button (click)="startEditConsole(i)" class="px-2 py-1 bg-yellow-500 text-white rounded text-xs">Editar</button>
              <button (click)="deleteConsole(console, i)" class="px-2 py-1 bg-red-500 text-white rounded text-xs">Eliminar</button>
            </div>
            <div *ngIf="editConsoleIndex === i" class="flex space-x-2">
              <button (click)="saveEditConsole(console)" class="px-2 py-1 bg-green-500 text-white rounded text-xs">Guardar</button>
              <button (click)="cancelEditConsole()" class="px-2 py-1 bg-gray-500 text-white rounded text-xs">Cancelar</button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="consoles.length === 0 && !isLoading" class="text-center py-8 text-gray-500">
      No hay consolas disponibles
    </div>
  </div>

  <!-- Sección de Accesorios -->
  <div class="mb-8">
    <h2 class="text-2xl font-bold mb-4">Accesorios</h2>

    <!-- Botón alternar formulario -->
    <button (click)="showAddAccessoryForm = !showAddAccessoryForm"
            class="mb-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition">
      {{ showAddAccessoryForm ? 'Cancelar' : 'Agregar Accesorio' }}
    </button>

    <!-- Tabla de Accesorios -->
    <table *ngIf="accessories.length > 0" class="min-w-full bg-white border border-gray-300 rounded">
      <thead>
        <tr>
          <th class="py-2 px-4 border-b">Imagen</th>
          <th class="py-2 px-4 border-b">Nombre</th>
          <th class="py-2 px-4 border-b">Categoría</th>
          <th class="py-2 px-4 border-b">Descripción</th>
          <th class="py-2 px-4 border-b">Precio</th>
          <th class="py-2 px-4 border-b">Stock</th>
          <th class="py-2 px-4 border-b">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let accessory of accessories; let i = index" class="hover:bg-gray-100">
          <td class="py-2 px-4 border-b">
            <img *ngIf="accessory.imageUrl" [src]="accessory.imageUrl" [alt]="accessory.name" class="w-16 h-16 object-cover rounded" />
            <span *ngIf="!accessory.imageUrl" class="text-gray-500">Sin imagen</span>
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editAccessoryIndex !== i">{{ accessory.name }}</span>
            <input *ngIf="editAccessoryIndex === i" type="text" [(ngModel)]="editedAccessory.name"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editAccessoryIndex !== i">{{ accessory.category || 'N/A' }}</span>
            <input *ngIf="editAccessoryIndex === i" type="text" [(ngModel)]="editedAccessory.category"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editAccessoryIndex !== i">{{ accessory.description || 'Sin descripción' }}</span>
            <textarea *ngIf="editAccessoryIndex === i" [(ngModel)]="editedAccessory.description"
                      class="w-full border border-gray-300 px-2 py-1 rounded text-sm" rows="2"></textarea>
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editAccessoryIndex !== i">{{ accessory.price | currency }}</span>
            <input *ngIf="editAccessoryIndex === i" type="number" [(ngModel)]="editedAccessory.price"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <span *ngIf="editAccessoryIndex !== i" [class]="getStockClass(accessory.stock)">{{ accessory.stock }}</span>
            <input *ngIf="editAccessoryIndex === i" type="number" [(ngModel)]="editedAccessory.stock"
                   class="w-full border border-gray-300 px-2 py-1 rounded text-sm" />
          </td>
          <td class="py-2 px-4 border-b">
            <div *ngIf="editAccessoryIndex !== i" class="flex space-x-2">
              <button (click)="startEditAccessory(i)" class="px-2 py-1 bg-yellow-500 text-white rounded text-xs">Editar</button>
              <button (click)="deleteAccessory(accessory, i)" class="px-2 py-1 bg-red-500 text-white rounded text-xs">Eliminar</button>
            </div>
            <div *ngIf="editAccessoryIndex === i" class="flex space-x-2">
              <button (click)="saveEditAccessory(accessory)" class="px-2 py-1 bg-green-500 text-white rounded text-xs">Guardar</button>
              <button (click)="cancelEditAccessory()" class="px-2 py-1 bg-gray-500 text-white rounded text-xs">Cancelar</button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="accessories.length === 0 && !isLoading" class="text-center py-8 text-gray-500">
      No hay accesorios disponibles
    </div>
  </div>


